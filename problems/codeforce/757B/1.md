---
oj: "CF"
problem_id: "757B"
title: "Bash's Big Day"
date: 2025-12-13 11:26
toc: true
tags: ["数论","埃式筛"]
desc: ""
source: https://codeforces.com/problemset/problem/757/B
---

[[TOC]]

题目说：如果选出的数字最大公约数为 1，它们就会打架。我们要选最多的人且不打架。

反过来想： 为了让它们不打架，选出的所有数字的最大公约数 $g$ 必须满足 $g > 1$。


这等价于：选出的所有数字都必须是某个整数 $x (x > 1)$ 的倍数。


贪心策略我们不需要找出那个具体的最大公约数是多少，我们只需要找到一个因子 $x$，使得输入数组中有最多的数是 $x$ 的倍数。

问题就变成了：在 $2$ 到 $100000$（题目中 $s_i$ 的最大值）之间，哪一个整数 $x$ 能整除输入数组中数量最多的元素？


算法流程

1. 桶记录（Frequency Array）：因为数字范围比较小（$10^5$），我们可以先用一个数组 cnt[] 记录每个力量值出现的次数。比如 cnt[4] = 2 表示力量为 4 的小精灵有 2 只。
2. 枚举因子（暴力枚举的优化）：我们需要枚举所有可能的公共因子 $i$（从 2 到 $100000$）。
3. 统计倍数：对于每一个因子 $i$，我们去统计它的倍数 $i, 2i, 3i, \dots$ 在输入数组中一共出现了多少次。即：$\text{Sum}_i = \text{cnt}[i] + \text{cnt}[2i] + \text{cnt}[3i] + \dots$
4. 取最大值：比较所有 $i$ 对应的总数，最大的那个就是答案。


时间复杂度分析（为什么这样做不会超时？）

你可能会担心：外层循环从 2 枚举到 $10^5$，内层循环还要枚举倍数，会不会超时？

这里就要用到**调和级数**的知识了。
设 $V$ 为数字的最大值（$10^5$）。

  * 当 $i=2$ 时，内层循环跑 $V/2$ 次。
  * 当 $i=3$ 时，内层循环跑 $V/3$ 次。
  * ...
  * 总运算次数 = $V/2 + V/3 + \dots + V/V = V \times (1/2 + 1/3 + \dots + 1/V)$。

这是一个调和级数，其和近似为 $\ln V$。
所以总复杂度是 $O(V \ln V)$。
对于 $V=10^5$，$V \ln V \approx 10^5 \times 11.5 \approx 1.15 \times 10^6$，这在计算机 1 秒钟能处理的 $10^8$ 次运算范围内，**非常快**。

## cpp 代码

@include-code(./1.cpp,cpp)

## haskell 代码 

@include-code(./1.hs,haskell)
