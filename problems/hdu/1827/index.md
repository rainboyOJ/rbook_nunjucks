---
oj: "HDU"
problem_id: "1827"
title: "Summer Holiday"
date: 2026-01-09 10:45
toc: true
tags: []
desc: ""
source: https://vjudge.net/problem/HDU-1827
pre:
 - luogu,P1314
book:
 - bookid
---

[[TOC]]

## 题目解析

这是一个非常经典的**强连通分量 (SCC) + 缩点 (Condensation)** 的题目。你的直觉完全正确：**SCC + DAG + 贪心/简单DP**。

## 题目核心解析

这个问题可以抽象为图论模型：

1. **点**：每个人是一个节点。
2. **边**：如果有关系 $X \to Y$，则有一条有向边。
3. **点权**：联系第 $i$ 个人的花费是 $Cost[i]$。
4. **传递性**：如果 $A$ 知道消息，且有通路 $A \to B$，则 $B$ 也能知道消息（免费）。

### 为什么需要 SCC (强连通分量)？

如果存在一个环（例如 $A \to B \to C \to A$），这三个人中只要通知其中任何一个人，其他人都会知道。

为了费用最小化，在这样一个“互相连通”的团体（SCC）里，我们肯定选择联系那个电话费最便宜的人。

### 为什么需要缩点成 DAG？

将每个 SCC 看作一个大点后，原图就变成了一个 有向无环图 (DAG)。

在 DAG 上，消息的传递是有方向的：

- 如果一个分量（SCC）有入度（In-degree > 0），说明消息可以从别的分量传过来，我们不需要单独花钱通知这个分量里的人（为了省钱，假定上游已经解决）。
- 如果一个分量**入度为 0**（源点），说明没有任何其他人能把消息传给他们。因此，**必须**从这个分量里挑一个人打电话。

## 算法流程

1. **Tarjan 算法求 SCC**：
   - 遍历所有点，找出所有的强连通分量。
   - 在寻找 SCC 的过程中（或者找到后），维护每个 SCC 内部的**最小花费** (`min_cost[scc_id]`)。
2. **缩点 (构建 DAG 逻辑)**：
   - 遍历原图的所有边 $(u, v)$。
   - 如果 $u$ 和 $v$ 属于不同的 SCC (`id[u] != id[v]`)，则说明存在一条从 `SCC[u]` 到 `SCC[v]` 的边。
   - 增加 `SCC[v]` 的入度 (`in_degree[id[v]]++`)。
3. **统计答案**：
   - 遍历所有的 SCC。
   - 如果某个 SCC 的入度为 **0**：
     - **需要联系的人数** +1。
     - **总费用** + 该 SCC 内的最小花费 (`min_cost[scc_id]`)。

------

## 代码实现 

@include-code(./1.cpp, cpp)

## 关键点总结

1. 为什么是 $InDegree == 0$？

   这就像河流的源头。如果是下游（入度>0），水（消息）总会流过来，不需要我们去“人工降雨”。只有源头（入度=0）必须人工干预。

2. 贪心策略：

   在同一个源头 SCC 内部，既然只要一个人知道全组都知道，那显然选最便宜的那个人（代码中 min_cost_scc 的维护）。

3. **时间复杂度**：

   - Tarjan: $O(N + M)$
   - 遍历边计算入度: $O(N + M)$
   - 统计: $O(N)$
   - 总复杂度 $O(N+M)$，对于 $N=1000, M=2000$ 的数据规模绰绰有余。

