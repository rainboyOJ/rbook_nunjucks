---
oj: "luogu"
problem_id: "P2613"
title: "【模板】有理数取余"
date: 2025-12-15 12:40
toc: true
tags: ["数论","逆元","费马小定理"]
desc: "大数取模"
source: https://www.luogu.com.cn/problem/P2613
---

[[TOC]]


## 1. 大数取模

利用取模的性质：

$$(A \times 10 + B) \pmod P = ((A \pmod P \times 10) \pmod P + B \pmod P) \pmod P$$

这是一道数论题目，主要考查以下两个知识点：

1.  **大数取模（读入优化）**：如何处理超长数字的取模。
2.  **模运算下的除法（乘法逆元）**：在模运算中，除以一个数等于乘以这个数的逆元。

下面我们分步拆解这道题的解法。

## 2. 核心: 逆元,费马小定理

题目要求计算 $c = \frac{a}{b} \pmod{P}$，其中 $P = 19260817$。

在模运算中，除法不能直接做，需要转化为乘法：

$$\frac{a}{b} \equiv a \times b^{-1} \pmod P$$

这里的 $b^{-1}$ 指的是 $b$ 在模 $P$ 意义下的**乘法逆元**。

**如何求逆元？**

首先，我们需要知道模数 $P = 19260817$ 是一个**质数**。

根据**费马小定理**：若 $P$ 是质数，且 $b$ 不是 $P$ 的倍数（即 $b \not\equiv 0 \pmod P$），则有：

$$b^{P-1} \equiv 1 \pmod P$$

变形一下：

$$b \times b^{P-2} \equiv 1 \pmod P$$

根据逆元的定义（$b \times b^{-1} \equiv 1$），我们可以得出：

$$b^{-1} \equiv b^{P-2} \pmod P$$

## 代码

@include-code(./1.cpp,cpp)

## 总结关键点：

1.  **模数性质**：$19260817$ 是质数，这是使用费马小定理求逆元的前提。
2.  **大数读入**：不需要高精度库，只需要在读入字符时利用秦九韶算法原理（`x = x*10 + c`）并时刻取模。
3.  **逆元公式**：$\frac{a}{b} \pmod P \iff a \times b^{P-2} \pmod P$。
