---
oj: "luogu"
problem_id: "P2341"
title: "[USACO03FALL / HAOI2006] 受欢迎的牛 G"
date: 2025-12-29 11:04
toc: true
tags: ["scc","dag"]
desc: "scc +dag"
source: https://www.luogu.com.cn/problem/P2341
pre:
 - luogu,P1314
book:
 - bookid
---

[[TOC]]

## 题目解析


这道题是 **Tarjan 缩点 + DAG 出度分析** 的经典应用。

### 题目解析

1. **喜欢关系的传递性**：
题目指出“喜欢”具有传递性。这意味着如果点  和点  处于同一个强连通分量（SCC）中，那么该分量内的所有奶牛都互相喜欢。
2. **缩点的必要性**：
我们可以将所有的 SCC 缩成一个点。缩点后，整个图变成了一个 **DAG（有向无环图）**。
3. **谁能成为明星？**
* 明星奶牛必须被“所有”奶牛喜欢。在缩点后的 DAG 中，这等价于：**该点必须能被 DAG 中所有其他节点到达**。
* 在 DAG 中，如果一个点的 **出度为 0**，说明它无法到达别人。
* **关键结论**：如果图中**只有一个**出度为 0 的 SCC，那么这个 SCC 里的所有奶牛都是明星。
* **为什么？** 如果有多个出度为 0 的 SCC（假设为  和 ），那么  里的奶牛无法到达 ，反之亦然。此时没有任何一头牛能被所有人喜欢。


4. **算法流程**：
* 运行 Tarjan 算法求出所有 SCC。
* 统计每个 SCC 的出度。
* 统计出度为 0 的 SCC 个数。
* 如果个数为 1，答案就是该 SCC 包含的奶牛数量；否则答案为 0。



---

### 代码实现

根据你的框架完成如下：

```cpp

```


## 代码 

@include-code(./1.cpp, cpp)

## 关键细节说明

1. **`tscc.sz` 数组**：我在 `TarjanScc` 结构体中添加了一个 `sz` 数组，用来在弹出栈时直接统计该强连通分量里有多少头奶牛。
2. **出度判定**：明星奶牛在 DAG 的“末端”，所以它们所在分量的出度必须为 0。如果有多于一个分量出度为 0，它们之间无法互通，就不存在能被“所有人”喜欢的奶牛。
