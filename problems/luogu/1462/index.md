---
oj: "luogu"
problem_id: "P1462"
title: "通往奥格瑞玛的道路"
date: 2025-12-25 08:31
toc: true
tags: ["图论","二分","最短路"]
desc: "最大最小"
source: https://www.luogu.com.cn/problem/P1462
---

[[TOC]]


## 题解析

这是一个经典的 「二分答案 + 最短路 (Dijkstra)」 的题目。

题目解析核心目标：我们需要找到一条从起点 $1$ 到终点 $n$ 的路径，满足总血量损失 $\le b$ 的前提下，使得路径上经过的所有城市中，收费最高的那个城市的费用尽可能小。

二分答案：题目要求“最大值的最小值”，具有明显的单调性：如果只允许经过收费 $\le X$ 的城市能到达终点，那么允许经过收费 $\le X+1$ 的城市肯定也能到达。

我们可以二分这个“最高收费上限” (limit)。Check 函数逻辑：对于给定的 limit，我们只允许经过收费 $f_i \le limit$ 的城市。在这些允许通行的城市构成的子图中，跑一遍 Dijkstra 最短路算法(想一想为什么要求最短路)。

边的权重是“血量损失”。最后判断：从 $1$ 到 $n$ 的最小血量损失是否 $\le b$。

特殊情况：

- 如果起点 $1$ 或终点 $n$ 的收费本身就大于 limit，直接返回 false。
- 如果无法连通，或者最小损失 $> b$，返回 false。
- 最终如果二分找不到答案，输出 AFK。


## 代码实现


### 重点细节说明

1. **数据类型**：
* 题目中血量  最大 ，但路径累加可能会超过 `int` 范围，所以 `dist` 数组必须用 `long long`。
* 二分的边界设为  比较稳妥，因为题目说 。


2. **Dijkstra 中的过滤**：
* 在松弛操作前，加入 `if (f[v] > limit) continue;`。这意味着如果某条路通向一个收费过高的城市，我们就把这条路当做不存在。
* **特别注意**：起点  和终点  也必须满足 `f[1] <= limit` 和 `f[n] <= limit`，这在 `check` 函数开头处理。


3. 时间复杂度：

- Dijkstra 复杂度约为 $O(M \log N)$。
- 二分查找范围是 $10^9$，次数约为 $\log(10^9) \approx 30$ 次。
- 总复杂度 $O(30 \cdot M \log N)$，对于 $M=50000$ 来说完全可以在 1 秒内跑完。

## 代码 

@include-code(./1.cpp, cpp)


