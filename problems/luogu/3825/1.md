---
oj: "luogu"
problem_id: "P3825"
title: "[NOI2017] 游戏"
date: 2025-12-23 10:24
toc: true
tags: ["2-sat","todo"]
desc: "核心: 把 2-sat 当作自动选择器使用"
source: https://www.luogu.com.cn/problem/P3825
---

[[TOC]]


TODO: 添加代码


2-SAT 算法本身就是一个“自动选择器”. 你不需要告诉它“选谁”，你只需要给它一个**“允许选谁的范围”**，它自己会在范围内找到解。


你的困惑非常合理。你是在从 **“赋值”**（Assignment）的角度思考，而标准解法是从 **“约束”**（Constraint）的角度思考。

**你卡住的地方在于：** 你认为要找到解，必须显式地告诉程序“这个位置选A”，或者“选B”，或者“选C”。
**但其实：** 2-SAT 算法本身就是一个“自动选择器”。你不需要告诉它“选谁”，你只需要给它一个**“允许选谁的范围”**，它自己会在范围内找到解。

为了让你从  的思路平滑过渡到 ，我们来看看这个思维推导过程。

---

### 第一步：理解 2-SAT 的能力

首先，我们要明确 **2-SAT 算法到底在干什么**。
当你把地图设为 （禁止 A）时，你并不是告诉程序“请选 B”或者“请选 C”。
你是在告诉程序：**“我不允许你选 A，剩下的 B 和 C，你自己看着办。”**

* 如果最优解是 B，2-SAT 会算出 B。
* 如果最优解是 C，2-SAT 会算出 C。
* **关键点**：在一个“禁止 A”的 2-SAT 模型里，它自动涵盖了对 B 和 C 的搜索。

### 第二步：从“指定值”到“指定范围”的推导

现在回到你的  思路。对于地图 ，真实答案可能是  中的一个。

#### 你的思路（枚举具体值）：

1. **假设 x = A**：跑一遍检测。
2. **假设 x = B**：跑一遍检测。
3. **假设 x = C**：跑一遍检测。

这是一个 **“点”** 的覆盖：你试图踩中那个正确的点。

#### 进阶思路（枚举搜索范围）：

我们要利用 2-SAT 的能力，能不能把这三个点，通过**“范围”**来覆盖？

* **范围 1（假装地图是 a）**：允许 。
* 这意味着：如果正确答案是 B，这个范围能搜到。
* 如果正确答案是 C，这个范围也能搜到。
* *（漏掉了 A）*


* **范围 2（假装地图是 b）**：允许 。
* 这意味着：如果正确答案是 A，这个范围能搜到。
* 如果正确答案是 C，这个范围也能搜到。
* *（漏掉了 B）*



#### 第三步：验证“覆盖”是否完整

现在我们把上面两个范围合起来看，能不能覆盖所有情况？

| 真实的最优解 (上帝视角) | 范围 1 (禁A: ) 能搜到吗？ | 范围 2 (禁B: ) 能搜到吗？ | 结论 |
| --- | --- | --- | --- |
| **是 A** | ❌ (A被禁了) | ✅ (允许A) | **能找到！** (在范围2中) |
| **是 B** | ✅ (允许B) | ❌ (B被禁了) | **能找到！** (在范围1中) |
| **是 C** | ✅ (允许C) | ✅ (允许C) | **能找到！** (两个都能) |

**看到了吗？**

* 我们不需要第三种情况（假装地图是 c，即允许 ）。因为 A 已经被范围 2 覆盖了，B 已经被范围 1 覆盖了，C 已经被两者都覆盖了。
* 只要我们试了“范围 1”和“范围 2”，无论真理是 A、B 还是 C，它一定会在其中某一次尝试中“落网”。

### 第四步：直观图解

这就好比你要抓一个嫌疑人（正确答案），嫌疑人藏在 A、B、C 三个房间中的一个。

* **你的方法（3-SAT 思维）**：
1. 冲进房间 A 抓人。
2. 冲进房间 B 抓人。
3. 冲进房间 C 抓人。


* (操作 3 次)


* **2-SAT 优化方法**：
如果你手头有一个搜查队（2-SAT 算法），它一次只能搜查两个房间。你怎么安排才能保证抓到人？
1. **第一次安排**：命令搜查队搜查 **{B, C}**。
* 如果人在 B 或 C，搜查队就抓到了。


2. **第二次安排**：命令搜查队搜查 **{A, C}**。
* 如果人在 A 或 C，搜查队就抓到了。




**结果**：
* 如果人在 A，第二次抓到了。
* 如果人在 B，第一次抓到了。
* 如果人在 C，两次都能抓到。



你不需要单独派人去搜查“A和B”（即模拟地图 c），因为前两次行动已经覆盖了所有可能藏人的地点。

### 总结

从“枚举 A,B,C”到“枚举地图 a,b”的推导逻辑链是：

1. **2-SAT 的特性**：给它两个选项，它能自动判断取哪个。
2. **目标转化**：我们不需要帮 2-SAT 选定“具体是哪个车”，我们要给它一个 **“包含正确答案的 2 选 1 环境”**。
3. **集合覆盖**：
* 
* 全集  (地图a的范围)  (地图b的范围)



所以，我们并没有丢失任何解，只是利用 2-SAT 的自动求解能力，把枚举量从 3 压缩到了 2。
