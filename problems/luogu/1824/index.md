---
oj: "luogu"
problem_id: "P1824"
title: "[USACO05FEB] 进击的奶牛 Aggressive Cows G"
date: 2025-12-25 08:45
toc: true
tags: ["二分"]
desc: "标准的二分答案"
source: https://www.luogu.com.cn/problem/P1824
---

[[TOC]]

## 题目解析


最大化最近的两头牛之间的距离: 最小最大->二分





这是一个经典的 **「二分答案 + 贪心 Check」** 的题目。

## 1 题目解析与单调性证明

**题目核心**： 我们需要在  $n$  个牛舍中选择  $m$  个，使得这  $m$  个牛舍中，**相邻两个牛舍的最小距离值最大**。

**解题思路**： 直接去计算“最大的最小距离”很难，但如果我们反过来思考： “给出一个距离  $d$ ，能不能放下  $m$  头牛，使得任意两头牛间距都  $\ge d$ ？” 这个问题很容易用贪心算法解决：

1.  先把牛舍位置排序。
2.  第一头牛放在第一个位置。
3.  之后每头牛都放在离上一头牛距离  $\ge d$  的最近位置。
4.  看最终能不能放得下  $m$  头牛。

因为答案具有单调性，我们可以对距离  $d$  进行**二分查找**。

* * *

#### 使用反证法证明单调性

**命题**： 设  $P\left(d\right)$  表示“最小距离为  $d$  时，能否成功放入  $m$  头牛”。 若  $d$  是一个合法的解（即  $P\left(d\right)$  为真），那么任何小于  $d$  的距离  $d^{′}$  ( $d^{′}<d$ ) 也一定合法。

**反证法证明**：

1.  **假设**命题不成立。即：存在一个距离  $d$  是合法的（ $P\left(d\right)$  为真），但在  $d$  之前存在一个更小的距离  $d^{′}$  ( $d^{′}<d$ ) 是**不合法**的（ $P\left(d^{′}\right)$  为假）。
2.  **推导**：
    *   既然  $P\left(d\right)$  为真，说明我们可以找到  $m$  个位置  $x_{p1},x_{p2},\dots ,x_{pm}$ ，满足任意相邻两点  $x_{p\left(i+1\right)}-x_{pi}\ge d$ 。
    *   已知  $d>d^{′}$ 。
    *   根据不等式的传递性，如果  $A\ge d$  且  $d>d^{′}$ ，那么必然有  $A>d^{′}$ 。
    *   因此，这  $m$  个位置同样满足  $x_{p\left(i+1\right)}-x_{pi}>d^{′}$ 。
3.  **矛盾**：
    *   推导结果表明，对于距离  $d^{′}$ ，我们也至少能找到一种方案（即  $d$  对应的那个方案）放下  $m$  头牛。
    *   这说明  $P\left(d^{′}\right)$  应该为真。
    *   这与假设（ $P\left(d^{′}\right)$  为假）相矛盾。
4.  **结论**：
    *   假设不成立。
    *   原命题成立：如果距离  $d$  可行，那么所有小于  $d$  的距离都可行。

这意味着答案分布是这样的：`[可行, 可行, ..., 可行, (最大值), 不可行, 不可行...]`。 这正是二分查找适用的场景。

* * *

## 2 代码实现

为了适配模板（`bs_find` 寻找第一个满足条件的位置），我们需要稍微转换一下思维：

*   你的模板中：当 `check` 为真时，执行 `r = m`（向左找）。
*   通常题目是求“可行”的最大值。
*   我们可以定义 `check` 函数为：**“判断距离  $x$  是否不可行（太大）”**。
    *   如果距离  $x$  **太大（不可行）**，返回 `true`。此时我们要找更小的，`r = m`，符合模板。
    *   如果距离  $x$  **可行**，返回 `false`。此时我们要找更大的，`l = m + 1`，符合模板。
*   最终 `bs_find` 返回的是**第一个不可行**的距离。
*   **答案就是** `bs_find(...) - 1`。
    

代码 

@include-code(./1.cpp, cpp)
